<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Budget Finance App</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="icon" type="image/x-icon" href="logo.png">
    <style>
      * {
        box-sizing: border-box;
        font-family: "Inter", sans-serif;
      }
      body {
        margin: 0;
        background: #f5f5f3;
        color: #222;
        padding: 1rem;
        height: 100vh;
        transition: background 0.3s, color 0.3s;
      }
      body.dark {
        background: #1e1e2f;
        color: #e0e0e0;
      }
      .logo{
        display: block;
        width: 68px;
        position: relative;
      }
      .layout {
        display: grid;
        grid-template-columns: 2fr 2fr;
        gap: 1rem;
        max-width: 1200px;
        margin: auto;
      }
      .cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
      }
      .card,
      .summary {
        background: #ffffff;
        border-radius: 12px;
        padding: 1rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        transition: background 0.3s, color 0.3s;
      }
      body.dark .card,
      body.dark .summary {
        background: #2c2c3e;
        color: #e0e0e0;
      }
      .card {
        border-left: 4px solid #aca7c5;
      }
      .summary {
        background: #dfdce5;
        margin-bottom: 1rem;
      }
      body.dark .summary {
        background: #3a3a4e;
      }
      .card h3,
      .summary h2 {
        margin-top: 0;
      }
      .input-row {
        display: flex;
        justify-content: space-between;
        margin: 0.5rem 0;
      }
      .input-row input,
      .dropdown input,
      .dropdown select {
        padding: 0.4rem;
        font-size: 1rem;
        border-radius: 6px;
        border: 1px solid #ccc;
        background: #f8f8f8;
        max-width: 6rem;
      }
      body.dark .input-row input,
      body.dark .dropdown input,
      body.dark .dropdown select {
        background: #444;
        color: #fff;
        border: 1px solid #666;
      }
      .highlight {
        font-weight: 600;
        color: #3f2d6a;
      }
      body.dark .highlight {
        color: #a6b5ff;
      }
      input,
      select {
        border-radius: 8px;
        background-color: #ffffff;
      }
      #analytics {
        margin-top: 2rem;
        padding: 1rem;
        border-radius: 10px;
        background: #e9e6f2;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        display: flex;
        justify-content: center;
        align-items: center;
        max-width: 62.6vw;
        min-height: 34vh;
        margin-left: auto;
        margin-right: auto;
        height: auto;
      }

      body.dark #analytics {
        background: #3d3d5c;
      }
      canvas {
        width: 100% !important;
        height: auto !important;
      }
      button {
        background-color: #585279;
        color: white;
        border: none;
        padding: 0.7rem 1.5rem;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1rem;
        margin-top: 1rem;
      }
      button:hover {
        background-color: #3d3552;
      }
      #darkToggle {
        position: fixed;
        top: 10px;
        right: 10px;
        z-index: 100;
      }
      @media (max-width: 768px) {
        .layout {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <button id="darkToggle">ON/OFF Dark Mode</button>
    <h2 style="text-align: center"><img class="logo" src="./logo.png" />    Budget Finance Calculator</h2>
    <h5 style="text-align: center; color: #666">By Vishwash C V / Cospeld</h5>
    <div class="layout">
      <div>
        <div class="cards">
          <div class="card">
            <h3>Time-based Spending</h3>
            <div class="input-row">
              <span>6AM-12PM</span>
              <input type="number" id="morning" value="0" />
            </div>
            <div class="input-row">
              <span>12PM-4PM</span
              ><input type="number" id="afternoon" value="0" />
            </div>
            <div class="input-row">
              <span>4PM-7PM</span><input type="number" id="evening" value="0" />
            </div>
            <div class="input-row">
              <span>7PM-6AM</span><input type="number" id="night" value="0" />
            </div>
          </div>
          <div class="card">
            <h3>Investment</h3>
            <div class="input-row">
              <span>Amount</span
              ><input type="number" id="investment" value="0" />
            </div>
          </div>
          <div class="card">
            <h3>Desire Spending</h3>
            <div class="input-row">
              <span>Amount</span><input type="number" id="desire" value="0" />
            </div>
          </div>
          <div class="card">
            <h3>Revenue / Salary</h3>
            <div class="dropdown">
              <select id="period">
                <option value="daily">Daily</option>
                <option value="monthly">Monthly</option>
                <option value="yearly">Yearly</option>
              </select>
              <input
                type="number"
                id="revenue"
                placeholder="Enter Amount"
                value="0"
              />
            </div>
          </div>
        </div>
      </div>
      <div>
        <div class="summary">
          <h2>Results</h2>
          <p>
            Total Spending: <span class="highlight" id="totalSpend">0</span>
          </p>
          <p>
            Total Deductions (All):
            <span class="highlight" id="totalDeductions">0</span>
          </p>
          <p>
            Remaining Balance: <span class="highlight" id="remaining">0</span>
          </p>
          <p>
            Investment Saved:
            <span class="highlight" id="investPercent">0%</span>
          </p>
          <p>
            Desire Saved: <span class="highlight" id="desirePercent">0%</span>
          </p>
          <button onclick="downloadPDF()">Download PDF</button>
        </div>
      </div>
    </div>

    <div id="analytics">
      <canvas id="barChart" height="100"></canvas>
    </div>

    <script>
      const inputs = [
        "morning",
        "afternoon",
        "evening",
        "night",
        "investment",
        "desire",
        "revenue",
        "period",
      ];
      inputs.forEach((id) =>
        document.getElementById(id).addEventListener("input", calculate)
      );

      const barChart = new Chart(document.getElementById("barChart"), {
        type: "bar",
        data: {
          labels: [
            "6AM-12PM",
            "12PM-4PM",
            "4PM-7PM",
            "7PM-6AM",
            "Investment",
            "Desire",
          ],
          datasets: [
            {
              label: "Spending Breakdown",
              data: [0, 0, 0, 0, 0, 0],
              backgroundColor: [
                "#84a98c",
                "#cad2c5",
                "#52796f",
                "#354f52",
                "#2f3e46",
                "#8fbc8f",
              ],
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
            },
          },
        },
      });

      function calculate() {
        const morning = +document.getElementById("morning").value;
        const afternoon = +document.getElementById("afternoon").value;
        const evening = +document.getElementById("evening").value;
        const night = +document.getElementById("night").value;
        const investment = +document.getElementById("investment").value;
        const desire = +document.getElementById("desire").value;
        const revenueRaw = +document.getElementById("revenue").value;
        const period = document.getElementById("period").value;

        let revenue = revenueRaw;
        if (period === "monthly") revenue = revenueRaw / 30;
        else if (period === "yearly") revenue = revenueRaw / 365;

        const totalSpend = morning + afternoon + evening + night;
        const totalDeductions = totalSpend + investment + desire;
        const remaining = revenue - totalDeductions;

        const investPercent =
          revenue > 0 ? Math.round((investment / revenue) * 100) : 0;
        const desirePercent =
          revenue > 0 ? Math.round((desire / revenue) * 100) : 0;

        document.getElementById("totalSpend").innerText = totalSpend;
        document.getElementById("totalDeductions").innerText = totalDeductions;
        document.getElementById("remaining").innerText = remaining;
        document.getElementById("investPercent").innerText =
          investPercent + "%";
        document.getElementById("desirePercent").innerText =
          desirePercent + "%";

        barChart.data.datasets[0].data = [
          morning,
          afternoon,
          evening,
          night,
          investment,
          desire,
        ];
        barChart.update();
      }

      async function downloadPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.setFontSize(16);
        doc.text("Budget Finance Summary", 20, 20);
        doc.setFontSize(12);
        doc.text(
          "Total Spending: " + document.getElementById("totalSpend").innerText,
          20,
          40
        );
        doc.text(
          "Total Deductions: " +
            document.getElementById("totalDeductions").innerText,
          20,
          50
        );
        doc.text(
          "Remaining Balance: " +
            document.getElementById("remaining").innerText,
          20,
          60
        );
        doc.text(
          "Investment Saved: " +
            document.getElementById("investPercent").innerText,
          20,
          70
        );
        doc.text(
          "Desire Saved: " + document.getElementById("desirePercent").innerText,
          20,
          80
        );
        doc.save("finance_summary.pdf");
      }

      document.getElementById("darkToggle").addEventListener("click", () => {
        document.body.classList.toggle("dark");
      });

      calculate();
    </script>
  </body>
</html>
